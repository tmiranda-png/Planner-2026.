<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Planner 2026 - Clean Girl</title>
    
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <script src="https://unpkg.com/lucide@latest"></script>

    <script>
        // --- CONFIGURAÇÃO JÁ PREENCHIDA COM SEUS DADOS ---
        window.__firebase_config = JSON.stringify({
            apiKey: "AIzaSyB2KvW1Ot155Ac2uzVzLtCGobZ5-dQoXOE",
            authDomain: "planner-2026-a84a7.firebaseapp.com",
            projectId: "planner-2026-a84a7",
            storageBucket: "planner-2026-a84a7.firebasestorage.app",
            messagingSenderId: "669302877429",
            appId: "1:669302877429:web:887d60f7c5fdc7d463a9bc",
            measurementId: "G-P8GN3GRQPE"
        });

        window.__app_id = 'planner-clean-girl-v1';
        window.__gemini_api_key = ""; // IA Opcional
    </script>
</head>
<body class="bg-[#FDFBF7]">
    <div id="root"></div>

    <script type="text/babel" data-type="module">
        import { initializeApp } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-app.js";
        import { getFirestore, doc, setDoc, onSnapshot } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-firestore.js";
        import { getAuth, signInAnonymously, onAuthStateChanged } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-auth.js";

        // Ícones
        const { 
            Heart, Home, DollarSign, Calendar, CheckCircle, 
            Plus, Trash2, Sun, BookOpen, Menu, 
            X, Cloud, Youtube, Gift, 
            PenTool, ChevronRight, Activity, TrendingUp, Sparkles, Loader2,
            CalendarDays, Target, Briefcase, PieChart, Check,
            Users, Stethoscope, Quote, GraduationCap, HeartHandshake
        } = lucide;

        // Configuração Firebase
        const firebaseConfig = JSON.parse(window.__firebase_config);
        let app, auth, db;
        
        try {
            app = initializeApp(firebaseConfig);
            auth = getAuth(app);
            db = getFirestore(app);
            // Login Automático
            signInAnonymously(auth).catch(err => console.error("Erro Login:", err));
        } catch (e) {
            console.error("Erro Firebase:", e);
        }

        const appId = window.__app_id;

        const { useState, useEffect } = React;

        // Componentes Básicos
        const Title = ({ children, subtitle }) => (
            <div className="mb-6">
                <h2 className="text-3xl text-[#2C2C2C] font-normal italic mb-1" style={{fontFamily: 'serif'}}>{children}</h2>
                {subtitle && <p className="text-[#8C8C8C] text-sm font-light uppercase tracking-widest">{subtitle}</p>}
            </div>
        );

        const Card = ({ children, className = "" }) => (
            <div className={`bg-white rounded-xl border border-[#F0EAE0] shadow-sm p-6 ${className}`}>{children}</div>
        );

        const Button = ({ children, onClick, variant = "primary", className = "", disabled = false }) => {
            const base = "px-4 py-2 rounded-lg transition-all text-sm font-medium flex items-center justify-center gap-2";
            const style = variant === "primary" ? "bg-[#804653] text-white hover:bg-[#683642]" : "bg-[#F5F2EB] text-[#5C5C5C]";
            return <button onClick={onClick} disabled={disabled} className={`${base} ${style} ${className}`}>{children}</button>;
        };

        const App = () => {
            const [user, setUser] = useState(null);
            const [activeTab, setActiveTab] = useState('daily');
            const [isMobileMenuOpen, setIsMobileMenuOpen] = useState(false);
            const [saveStatus, setSaveStatus] = useState('saved');

            // Estado Inicial
            const initialState = {
                daily: { routine: [{ id: 1, time: '07:00', task: 'Acordar e Água com limão', completed: false }], notes: '' },
                weekly: { events: [] },
                spiritual: { readingPlan: [], completedReadingIds: [], weeklyVerse: '', prayerRoom: { professional: [], family: [] }, devotionalMessage: '' },
                health: { measurements: {}, composition: { muscle: 40, fat: 20, water: 30, bone: 10 }, appointments: [], healthNotes: '' },
                home: { daily: [], weekly: [], monthly: [] },
                reading: { current: [], pagesReadYear: 0 },
                finance: { transactions: [] },
                wishlist: { home: [], personal: [] },
                goals: { short: [], medium: [], long: [] },
                professional: { objectives: [], important: [] }
            };

            const [data, setData] = useState(initialState);
            const [inputs, setInputs] = useState({ text: '', time: '' });

            // Sincronização
            useEffect(() => {
                if(auth) onAuthStateChanged(auth, setUser);
            }, []);

            useEffect(() => {
                if (!user || !db) return;
                const docRef = doc(db, 'artifacts', appId, 'users', user.uid, 'planner_data', 'v1');
                const unsub = onSnapshot(docRef, (s) => {
                    if (s.exists()) setData(prev => ({ ...initialState, ...s.data() }));
                });
                return () => unsub();
            }, [user]);

            useEffect(() => {
                if (!user || !db) return;
                setSaveStatus('saving');
                const t = setTimeout(() => {
                    setDoc(doc(db, 'artifacts', appId, 'users', user.uid, 'planner_data', 'v1'), data)
                        .then(() => setSaveStatus('saved'))
                        .catch(() => setSaveStatus('error'));
                }, 1500);
                return () => clearTimeout(t);
            }, [data, user]);

            // Funções
            const handleInput = (f, v) => setInputs(p => ({ ...p, [f]: v }));
            const addItem = (mod, sub, item) => setData(p => ({ ...p, [mod]: { ...p[mod], [sub]: [...(p[mod][sub]||[]), item] } }));
            const removeItem = (mod, sub, id) => setData(p => ({ ...p, [mod]: { ...p[mod], [sub]: p[mod][sub].filter(i => i.id !== id) } }));
            const toggleComplete = (mod, sub, id) => setData(p => ({ ...p, [mod]: { ...p[mod], [sub]: p[mod][sub].map(i => i.id === id ? { ...i, completed: !i.completed } : i) } }));

            // Renderização Simplificada
            const renderDaily = () => (
                <div className="animate-fade-in space-y-6">
                    <Title subtitle="Planejamento de Hoje">Minha Rotina</Title>
                    <Card>
                        <div className="flex gap-2 mb-4">
                            <input placeholder="08:00" className="w-20 p-2 bg-[#F9F7F2] rounded" value={inputs.time} onChange={e => handleInput('time', e.target.value)} />
                            <input placeholder="Tarefa..." className="flex-1 p-2 bg-[#F9F7F2] rounded" value={inputs.text} onChange={e => handleInput('text', e.target.value)} />
                            <Button onClick={() => { if(inputs.text){ addItem('daily', 'routine', {id: Date.now(), time: inputs.time, task: inputs.text, completed:false}); setInputs({text:'', time:''}); } }}><Plus size={16}/></Button>
                        </div>
                        <div className="space-y-2">
                            {data.daily.routine.map(i => (
                                <div key={i.id} className="flex justify-between items-center p-2 hover:bg-[#F9F7F2] rounded">
                                    <div className="flex gap-4">
                                        <span className="font-bold text-[#804653] w-12">{i.time}</span>
                                        <span onClick={() => toggleComplete('daily', 'routine', i.id)} className={`cursor-pointer ${i.completed ? 'line-through text-gray-400' : ''}`}>{i.task}</span>
                                    </div>
                                    <button onClick={() => removeItem('daily', 'routine', i.id)}><Trash2 size={14} className="text-gray-300 hover:text-red-400"/></button>
                                </div>
                            ))}
                        </div>
                    </Card>
                </div>
            );

            // Menu
            const MenuBtn = ({id, label, icon: Icon}) => (
                <button onClick={() => { setActiveTab(id); setIsMobileMenuOpen(false); }} className={`w-full flex items-center gap-4 px-6 py-3 ${activeTab === id ? 'bg-[#F5F2EB] border-r-4 border-[#804653]' : 'hover:bg-gray-50'}`}>
                    <Icon size={18} className={activeTab === id ? 'text-[#804653]' : 'text-gray-400'} />
                    <span className="text-sm font-medium text-gray-600">{label}</span>
                </button>
            );

            return (
                <div className="min-h-screen flex bg-[#FDFBF7]">
                    <aside className={`fixed md:relative z-20 w-64 h-full bg-white border-r flex flex-col transition-all ${isMobileMenuOpen ? 'translate-x-0' : '-translate-x-full md:translate-x-0'}`}>
                        <div className="p-8"><h1 className="text-2xl italic text-[#2C2C2C]" style={{fontFamily: 'serif'}}>Planner 2026</h1></div>
                        <nav className="flex-1 overflow-y-auto">
                            <MenuBtn id="daily" label="Diário" icon={Sun} />
                            <MenuBtn id="weekly" label="Semanal" icon={Calendar} />
                            <MenuBtn id="goals" label="Objetivos" icon={Target} />
                            <MenuBtn id="finance" label="Financeiro" icon={DollarSign} />
                            <MenuBtn id="home" label="Casa" icon={Home} />
                        </nav>
                        <div className="p-4 text-xs text-center text-gray-400">Status: {saveStatus}</div>
                    </aside>
                    
                    <div className="md:hidden fixed top-0 w-full bg-white p-4 border-b z-10 flex justify-between">
                        <span>Planner</span>
                        <button onClick={() => setIsMobileMenuOpen(!isMobileMenuOpen)}><Menu/></button>
                    </div>

                    <main className="flex-1 p-8 pt-20 md:pt-8 overflow-y-auto h-screen">
                        {activeTab === 'daily' && renderDaily()}
                        {activeTab !== 'daily' && <div className="text-center mt-20 text-gray-400">Selecione "Diário" para testar.
